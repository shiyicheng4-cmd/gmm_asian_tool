<!doctype html>

<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Football Edge â€” å›æµ‹ä¸æ¨¡å‹å±•ç¤º</title>
  <meta name="description" content="ä¸¤å¹´æœŸå›æµ‹ä¸èµ”ç‡/xGæ¨¡å‹æ¼”ç¤ºï¼Œè‡ªåŠ¨è¯»å– output/ ä¸‹çš„ç»“æœå¹¶å±•ç¤ºã€‚" />
  <meta name="theme-color" content="#0f172a">
  <style>
    :root{
      --bg: #0b1020; --panel: #111827; --panel2:#0f172a; --text:#e5e7eb; --muted:#94a3b8; --brand:#22d3ee; --accent:#60a5fa; --ring: rgba(34,211,238,.35);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0; font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: radial-gradient(1200px 600px at 20% -10%, rgba(96,165,250,.12), transparent),
                  radial-gradient(800px 400px at 120% 10%, rgba(34,211,238,.12), transparent), var(--bg);
      color:var(--text); line-height:1.6;}
    a{color:var(--brand); text-decoration:none}
    a:hover{text-decoration:underline}
    .container{max-width:1100px;margin:auto;padding:24px}
    .nav{display:flex;align-items:center;justify-content:space-between;gap:16px}
    .badge{display:inline-flex;align-items:center;gap:8px;background:linear-gradient(90deg,var(--panel),var(--panel2));border:1px solid rgba(148,163,184,.2);padding:6px 10px;border-radius:9999px;color:var(--muted);font-size:12px}
    .hero{display:grid;grid-template-columns:1.2fr .8fr;gap:28px;margin:28px 0;align-items:center}
    @media (max-width:900px){.hero{grid-template-columns:1fr}}
    .card{background: linear-gradient(180deg, rgba(255,255,255,.02), rgba(255,255,255,.01)); border:1px solid rgba(148,163,184,.15); border-radius:20px; padding:22px; backdrop-filter: blur(6px); box-shadow: 0 10px 30px rgba(2,8,23,.45);}
    .title{font-size:clamp(28px,5vw,44px); line-height:1.2; margin:8px 0 12px}
    .subtitle{color:var(--muted);font-size:15px}
    .cta{display:flex;gap:12px;flex-wrap:wrap;margin-top:16px}
    .btn{padding:10px 14px;border-radius:12px;border:1px solid rgba(148,163,184,.25);background:#0b1220;color:#eaf2f7;cursor:pointer}
    .btn.primary{background:linear-gradient(135deg, var(--accent), var(--brand)); color:#05121a; font-weight:700; border:none}
    .btn:hover{filter:brightness(1.06)}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:18px;margin-top:18px}
    @media (max-width:900px){.grid{grid-template-columns:1fr}}
    .metric{display:flex;align-items:center;gap:16px}
    .metric svg{flex:0 0 44px}
    .metric h3{margin:0;font-size:18px}
    .metric p{margin:4px 0 0;color:var(--muted);font-size:14px}
    .section{margin:36px 0}
    .section h2{font-size:22px;margin:0 0 12px}
    .code{font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; font-size:13px; background:#0b1220; border:1px solid rgba(148,163,184,.2); padding:12px;border-radius:12px; overflow:auto}
    footer{margin:40px 0 12px; color:var(--muted); font-size:12px; text-align:center}
    table{width:100%;border-collapse:collapse;font-size:14px}
    th,td{padding:8px;border-bottom:1px solid rgba(148,163,184,.12)}
    th{position:sticky;top:0;background:#0b1220}
    .scroll{max-height:420px;overflow:auto;border:1px solid rgba(148,163,184,.15);border-radius:12px}
    .hint{font-size:12px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="container">
    <div class="nav">
      <span class="badge">âš½ Football Edge Â· ä¸¤å¹´æœŸå›æµ‹æ¼”ç¤º</span>
      <a href="#live" class="badge" style="background:transparent">ğŸ“Š å®æ—¶ç»“æœ</a>
    </div><section class="hero">
  <div class="card">
    <h1 class="title">åŸºäº èµ”ç‡ Ã— xG çš„ 1X2 æ¨¡å‹</h1>
    <p class="subtitle">èåˆæ”¶ç›˜èµ”ç‡çš„éšå«æ¦‚ç‡ä¸ Understat æ»šåŠ¨ xGï¼ˆ3/5/10 åœºï¼‰ï¼Œç”¨æ—¶åºäº¤å‰éªŒè¯è®­ç»ƒï¼ŒæŒ‰ <strong>æ¨¡å‹å…¬å¹³æ¦‚ç‡ âˆ’ å¸‚åœºå…¬å¹³æ¦‚ç‡ â‰¥ 2.5%</strong> ä¸” <strong>èµ”ç‡â‰¥1.70</strong> è¿›è¡Œä¸‹æ³¨ç­›é€‰ï¼Œå¹¶é‡‡ç”¨ <strong>1/4 Kelly</strong> èµ„é‡‘ç®¡ç†ã€‚</p>
    <div class="cta">
      <a class="btn primary" href="#live">æŸ¥çœ‹æœ€æ–°å›æµ‹</a>
      <a class="btn" href="#how">å¦‚ä½•éƒ¨ç½²</a>
    </div>
  </div>
  <div class="card" id="equityCard">
    <img id="equityImg" src="output/equity_curve.png" alt="Equity Curve" style="max-width:100%;border-radius:14px;display:none;border:1px solid rgba(148,163,184,.2)"/>
    <svg id="equitySvg" viewBox="0 0 700 300" width="100%" height="220" role="img" aria-label="Equity curve from CSV" style="display:none"></svg>
    <p class="subtitle" id="equityNote" style="margin-top:8px">å°è¯•åŠ è½½ <code>output/equity_curve.png</code>â€¦</p>
  </div>
</section>

<section id="live" class="section">
  <h2>æœ€æ–°å›æµ‹ç»“æœ</h2>
  <div class="grid">
    <div class="card metric"><svg viewBox="0 0 48 48"><circle cx="24" cy="24" r="22" fill="#0b1220" stroke="rgba(148,163,184,.3)"/><path d="M10 28l8 6 20-18" stroke="var(--brand)" stroke-width="3" fill="none"/></svg><div><h3>ROI</h3><p id="kpiRoi">â€”</p></div></div>
    <div class="card metric"><svg viewBox="0 0 48 48"><rect x="4" y="6" width="40" height="28" rx="6" fill="#0b1220" stroke="rgba(148,163,184,.3)"/><path d="M10 30h28" stroke="var(--accent)" stroke-width="3"/><circle cx="34" cy="34" r="6" fill="var(--accent)"/></svg><div><h3>å‘½ä¸­ç‡</h3><p id="kpiHit">â€”</p></div></div>
    <div class="card metric"><svg viewBox="0 0 48 48"><circle cx="24" cy="24" r="22" fill="#0b1220" stroke="rgba(148,163,184,.3)"/><path d="M10 24h28" stroke="var(--brand)" stroke-width="3"/><path d="M24 10v28" stroke="var(--brand)" stroke-width="3"/></svg><div><h3>æ ·æœ¬é‡</h3><p id="kpiN">â€”</p></div></div>
  </div>

  <div class="card" style="margin-top:16px">
    <div style="display:flex;align-items:center;justify-content:space-between;gap:12px;flex-wrap:wrap">
      <h3 style="margin:0">äº¤æ˜“æ˜ç»†</h3>
      <a id="dlCsv" class="badge" href="output/backtest_trades.csv" download>â¬‡ï¸ ä¸‹è½½ backtest_trades.csv</a>
    </div>
    <p class="hint">é»˜è®¤å±•ç¤ºå‰ 200 è¡Œï¼ˆæ›´å¤šè¯·ä¸‹è½½ CSVï¼‰ã€‚</p>
    <div class="scroll"><table id="tradesTbl"><thead></thead><tbody></tbody></table></div>
  </div>
</section>

<section id="how" class="section">
  <h2>å¦‚ä½•éƒ¨ç½²/æ›´æ–°</h2>
  <div class="card">
    <ol>
      <li>æŠŠæœ¬æ–‡ä»¶ <code>index.html</code> æ”¾åœ¨ä»“åº“æ ¹ç›®å½•ï¼ˆæˆ– <code>docs/</code> å¹¶åœ¨ Pages é‡Œé€‰ docsï¼‰ã€‚</li>
      <li>å›æµ‹åå°† <code>output/</code> é‡Œçš„ <code>equity_curve.png</code>ã€<code>backtest_trades.csv</code>ã€<code>merged_dataset.csv</code> æ¨åˆ°ä»“åº“ã€‚</li>
      <li>ç­‰å¾… GitHub Pages åŒæ­¥å®Œæˆï¼Œåˆ·æ–°æœ¬é¡µé¢å³å¯çœ‹åˆ°æœ€æ–°ç»“æœã€‚</li>
    </ol>
  </div>
</section>

<footer>Â© <span id="y"></span> Football Edge. ä»…ä½œæ•™è‚²ä¸ç ”ç©¶ç”¨é€”ï¼Œä¸æ„æˆæŠ•èµ„/åšå½©å»ºè®®ã€‚</footer>

  </div>  <!-- CSV è§£æåº“ -->  <script src="https://unpkg.com/papaparse@5.4.1/papaparse.min.js"></script>  <script>
    document.getElementById('y').textContent = new Date().getFullYear();

    // ä¼˜å…ˆæ˜¾ç¤ºæœ¬åœ° equity_curve.pngï¼Œä¸å­˜åœ¨åˆ™ä» CSV è®¡ç®—ç»˜åˆ¶ç®€æ˜“æ›²çº¿
    (function loadEquity(){
      const img = document.getElementById('equityImg');
      const note = document.getElementById('equityNote');
      fetch('output/equity_curve.png', {method:'HEAD'}).then(r=>{
        if(r.ok){ img.style.display='block'; note.textContent='æ¥è‡ª output/equity_curve.png'; }
        else{ drawEquityFromCSV(); }
      }).catch(drawEquityFromCSV);
    })();

    function drawEquityFromCSV(){
      const svg = document.getElementById('equitySvg');
      const note = document.getElementById('equityNote');
      svg.style.display='block';
      Papa.parse('output/backtest_trades.csv', {download:true, header:true, complete: (res)=>{
        const rows = res.data.filter(r=>r.equity && !isNaN(+r.equity));
        if(!rows.length){ note.textContent='æœªæ‰¾åˆ° equity_curve.pngï¼Œä¸” CSV æ—  equity åˆ—ã€‚'; return; }
        const eq = rows.map(r=>+r.equity);
        // ç”»ç®€å•æŠ˜çº¿
        const W=700,H=300,pad=28; const min=Math.min(...eq), max=Math.max(...eq);
        const x=(i)=> pad + (i/(eq.length-1))*(W-2*pad);
        const y=(v)=> H-pad - ((v-min)/(max-min||1))*(H-2*pad);
        let d=''; eq.forEach((v,i)=>{ d += (i? 'L':'M')+x(i)+','+y(v)+' '; });
        svg.innerHTML = `<rect x="0" y="0" width="${W}" height="${H}" fill="#0b1220" rx="14"/>
          <path d="${d}" stroke="url(#g)" fill="none" stroke-width="3"/>
          <defs><linearGradient id="g" x1="0" y1="0" x2="0" y2="1"><stop offset="0%" stop-color="rgba(96,165,250,.9)"/><stop offset="100%" stop-color="rgba(34,211,238,.4)"/></linearGradient></defs>`;
        note.textContent='åŸºäº CSV çš„æƒç›Šæ›²çº¿ï¼ˆoutput/backtest_trades.csvï¼‰';
      }});
    }

    // æ¸²æŸ“äº¤æ˜“è¡¨ + KPI
    Papa.parse('output/backtest_trades.csv', {
      download:true, header:true, dynamicTyping:true,
      complete: function(res){
        const data = res.data.filter(r=>r.date && r.odds);
        // KPI
        const n = data.length;
        let stakeSum=0, pnlSum=0, winSum=0;
        data.forEach(r=>{ stakeSum += +r.stake||0; pnlSum += +r.pnl||0; winSum += (+r.win||0); });
        const roi = stakeSum>0? (pnlSum/stakeSum): 0;
        document.getElementById('kpiN').textContent = n? n.toLocaleString(): 'â€”';
        document.getElementById('kpiRoi').textContent = (roi*100).toFixed(2)+'%';
        document.getElementById('kpiHit').textContent = n? ((winSum/n)*100).toFixed(2)+'%':'â€”';

        // è¡¨æ ¼
        const cols = ["date","home","away","sel","odds","prob","stake","ev","win","pnl","equity"]; 
        const head = document.querySelector('#tradesTbl thead');
        const body = document.querySelector('#tradesTbl tbody');
        head.innerHTML = `<tr>${cols.map(c=>`<th>${c}</th>`).join('')}</tr>`;
        const shown = data.slice(0,200);
        body.innerHTML = shown.map(r=>`<tr>${cols.map(c=>`<td>${r[c]??''}</td>`).join('')}</tr>`).join('');
      },
      error: function(){
        document.querySelector('#tradesTbl thead').innerHTML = '';
        document.querySelector('#tradesTbl tbody').innerHTML = '<tr><td>æ‰¾ä¸åˆ° output/backtest_trades.csv</td></tr>';
      }
    });
  </script></body>
</html>
